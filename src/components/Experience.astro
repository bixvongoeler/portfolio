---
import { siteConfig } from "../config";
import SectionLayout from "./SectionLayout.astro";
import SectionHeader from "./SectionHeader.astro";

const hasExperience = siteConfig.experience && siteConfig.experience.length > 0;
---

{
    hasExperience && (
        <SectionLayout id="experience">
            <SectionHeader title="Experience" />

            <div class="lg:col-span-8">
                <div class="relative">
                    {siteConfig.experience.map((exp, index) => (
                        <div class="relative mb-12 last:mb-0">
                            {/* Timeline dot at top of card */}
                            <div class={`absolute left-1/2 -top-2 w-4 h-4 rounded-full -translate-x-1/2 z-20 transition-all duration-300 ${
                                exp.current
                                    ? "bg-[var(--accent-color)] border-2 border-[var(--accent-color)]"
                                    : "bg-gray-400 dark:bg-slate-500 border-2 border-gray-400 dark:border-slate-500"
                            }`} />

                            {/* Connecting line below card */}
                            {index < siteConfig.experience.length - 1 && (
                                <div class="absolute left-1/2 bottom-0 w-0.5 h-12 bg-gray-300 dark:bg-slate-600 -translate-x-1/2 translate-y-full z-10" />
                            )}

                            {/* Experience card */}
                            <div
                                data-tilt={siteConfig.tiltEffect?.enabled ? "" : undefined}
                                data-tilt-max={siteConfig.tiltEffect?.max}
                                data-tilt-speed={siteConfig.tiltEffect?.speed}
                                data-tilt-perspective={siteConfig.tiltEffect?.perspective}
                                class={`rounded-lg p-4 sm:p-5 md:p-6 transition-shadow duration-300 ${
                                    exp.current
                                        ? "current-experience bg-white dark:bg-slate-800 border-2 border-[var(--accent-color)]"
                                        : "bg-gray-50 dark:bg-slate-800/60 border border-gray-200 dark:border-slate-700 shadow-sm hover:shadow-md"
                                }`}
                            >
                                <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between mb-4">
                                    <div>
                                        <h3 class="text-lg sm:text-xl font-semibold text-gray-900 dark:text-slate-50">
                                            {exp.title}
                                        </h3>
                                        <p class="text-base sm:text-lg text-[var(--accent-color)]">{exp.company}</p>
                                    </div>
                                    <span class={`text-sm sm:text-base mt-2 sm:mt-1 ${exp.current ? "text-gray-700 dark:text-slate-300" : "text-gray-600 dark:text-slate-400"}`}>
                                        {exp.dateRange.includes("Present") ? (
                                            <>
                                                {exp.dateRange.replace("Present", "")}
                                                <span class="text-[var(--accent-color)] font-medium">Present</span>
                                            </>
                                        ) : (
                                            exp.dateRange
                                        )}
                                    </span>
                                </div>

                                <ul class="space-y-2">
                                    {exp.bullets.map((bullet) => (
                                        <li class="flex items-start">
                                            <span class="inline-block w-1.5 h-1.5 rounded-full bg-gray-400 dark:bg-slate-500 mt-2 mr-3 flex-shrink-0" />
                                            <span class="text-sm sm:text-base text-gray-600 dark:text-slate-400" set:html={bullet} />
                                        </li>
                                    ))}
                                </ul>
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        </SectionLayout>
    )
}

<style>
    .current-experience {
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.15), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
    }

    .current-experience:hover {
        box-shadow: 0 20px 35px -5px rgba(0, 0, 0, 0.2), 0 10px 15px -6px rgba(0, 0, 0, 0.15);
    }

    :global(.dark) .current-experience {
        box-shadow: 0 10px 25px -5px rgba(255, 255, 255, 0.1), 0 8px 10px -6px rgba(255, 255, 255, 0.08);
    }

    :global(.dark) .current-experience:hover {
        box-shadow: 0 20px 35px -5px rgba(255, 255, 255, 0.15), 0 10px 15px -6px rgba(255, 255, 255, 0.1);
    }
</style>
